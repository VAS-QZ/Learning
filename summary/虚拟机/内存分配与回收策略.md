# 内存分配与回收策略

Java内存中，GC分为两类，Minor GC和Full GC。Minor GC针对年轻代进行GC，Full GC针对整个堆进行GC。JVM的内存晋升流程图如下

```mermaid
graph TB
	a(新建一个对象)-->b{大于设定的<br>最大内存值}
	b--是-->c(在老年代中创建)
	b--否-->d{Eden区是否<br>有足够内存}
	d--是-->e(在Eden区创建)
	d--否-->g(Minor GC)
	subgraph Minor GC
		g{survior区可以容纳<br>所有存活的对象}--是-->h(将survior区作为复制目标区域)
		g--否-->i{老年代是否可以容纳<br>所有存活的对象}
		i--是-->j(将老年代作为复制目标区域)
		i--否-->k(触发Full GC)
	end
```

在survior区中的对象，在符合两种情况时，也是可以晋升到老年代的

- survior区中的对象，每经历过一次Minor GC而没有被回收掉就会使其年龄+1，当年龄大于我们设定的年龄值时，就会晋升到老年代中
- 如果survior区中同一年龄的对象大于Survior区的一半，那么这些对象也会晋升到到老年代